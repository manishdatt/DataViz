{
  "hash": "d07b5a97cde9ca8f8554711f975c2b8c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Water Quality at Sydney Beaches\"\nauthor: \"Manish Datt\"\ndate: \"5/20/2025\"\ndescription: \"Ranking of Sydney beaches based on *Enterococci* concentration\"\nimage: \"swim_sites.png\"\ncategories: [ggplot2, heatmap,TidyTuesday]\nslug: \"2553\"\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggtext)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwater_quality <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-05-20/water_quality.csv')\nwater_quality\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 123,530 × 10\n   region         council       swim_site date       time  enterococci_cfu_100ml\n   <chr>          <chr>         <chr>     <date>     <tim>                 <dbl>\n 1 Western Sydney Hawkesbury C… Windsor … 2025-04-28 11:00                   620\n 2 Sydney Harbour North Sydney… Hayes St… 2025-04-28 11:40                    64\n 3 Sydney Harbour Willoughby C… Northbri… 2025-04-28 10:54                   160\n 4 Sydney Harbour Northern Bea… Fairligh… 2025-04-28 09:28                    54\n 5 Western Sydney Hawkesbury C… Yarramun… 2025-04-28 10:35                   720\n 6 Sydney Harbour Northern Bea… Little M… 2025-04-28 09:19                   230\n 7 Sydney Harbour City of Cana… Chiswick… 2025-04-28 13:06                   120\n 8 Sydney Harbour Inner West C… Dawn Fra… 2025-04-28 08:04                   280\n 9 Sydney Harbour Woollahra Mu… Rose Bay… 2025-04-28 08:50                    60\n10 Sydney Harbour Woollahra Mu… Camp Cove 2025-04-28 09:09                   100\n# ℹ 123,520 more rows\n# ℹ 4 more variables: water_temperature_c <dbl>, conductivity_ms_cm <dbl>,\n#   latitude <dbl>, longitude <dbl>\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(water_quality)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 123,530\nColumns: 10\n$ region                <chr> \"Western Sydney\", \"Sydney Harbour\", \"Sydney Harb…\n$ council               <chr> \"Hawkesbury City Council\", \"North Sydney Council…\n$ swim_site             <chr> \"Windsor Beach\", \"Hayes Street Beach\", \"Northbri…\n$ date                  <date> 2025-04-28, 2025-04-28, 2025-04-28, 2025-04-28,…\n$ time                  <time> 11:00:00, 11:40:00, 10:54:00, 09:28:00, 10:35:0…\n$ enterococci_cfu_100ml <dbl> 620, 64, 160, 54, 720, 230, 120, 280, 60, 100, 1…\n$ water_temperature_c   <dbl> 20, 21, 21, 21, 18, 21, 21, 21, 22, 22, 20, 20, …\n$ conductivity_ms_cm    <dbl> 248, 45250, 48930, 52700, 64, 39140, 4845, 50600…\n$ latitude              <dbl> -33.60448, -33.84172, -33.80604, -33.80073, -33.…\n$ longitude             <dbl> 150.8170, 151.2194, 151.2228, 151.2748, 150.6979…\n```\n\n\n:::\n:::\n\n\n## Data Wrangling\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwq_grp <- water_quality %>%\n  filter(!is.na(enterococci_cfu_100ml)) %>% \n  mutate(date_y = format(date, \"%Y\")) %>% \n  group_by(date_y, swim_site) %>% \n  summarise(mean_enterococci = mean(enterococci_cfu_100ml, na.rm = TRUE)) %>% \n  slice_min(order_by = mean_enterococci, n = 5)\n\nsite_freq <- wq_grp %>%\n  ungroup() %>% \n  count(swim_site, sort = TRUE)\n```\n:::\n\n\n## Plotting\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwq_grp%>% \n  mutate(swim_site = fct_rev(factor(swim_site, levels = site_freq$swim_site))) %>% \n  ggplot(aes(x = date_y, y=swim_site, fill=mean_enterococci)) +\n  scale_fill_gradient(low = \"lightblue\", high = \"blue\") +\n  geom_tile(color=\"white\") +\n  labs(\n    title = \"Year-wise top five swim-sites based on the lowest *Enterococci* concentration\",\n    x = element_blank(),\n    y = element_blank(),\n    fill = \"Average *Enterococci* <br> CFU/100ml\",\n    caption = \"Colony Forming Units (CFU) indicate number of viable bacteria that can form colonies when grown in a lab.\"\n  ) +\n  theme_minimal() +\n  theme(\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.text.x = element_text(angle = 90, hjust = 1),\n    plot.title = element_textbox_simple(\n      padding = margin(5.5, 5.5, 5.5, 5.5),\n      margin = margin(5, 0, 10, 0)),\n    legend.title = element_markdown(hjust = 0.5),\n    legend.position = \"inside\",\n    legend.position.inside = c(0.80, 0.1),\n    legend.title.position = \"top\",\n    plot.caption = element_textbox_simple(\n      margin = margin(0, 0, 10, 175),\n      padding = margin(5.5, 0, 0, 0),\n      hjust = 0,\n      size = 8,\n      color = \"gray40\",\n      lineheight = 1.2\n    ),\n    axis.title.x = element_text(family = \"Consolas\"),\n    ) +\n  guides(fill = guide_colorbar(direction = \"horizontal\", barheight=.5)) +\n   coord_fixed(ratio = 1) \n```\n\n::: {.cell-output-display}\n![](swim_sites_files/figure-html/unnamed-chunk-5-1.png){width=960}\n:::\n\n```{.r .cell-code}\n#ggsave(\"swim_sites2.png\", width = 8, height = 6, dpi = 300, bg = \"white\")\n```\n:::\n\n",
    "supporting": [
      "swim_sites_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}