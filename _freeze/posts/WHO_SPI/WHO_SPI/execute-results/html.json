{
  "hash": "05f0b573c446deceb69fb59a8514eda3",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: WHO Statistical Performance Indicators\nmarimo-version: 0.17.0\nauthor: Manish Datt\ndate: '2025-11-25'\niso-date: '2025-11-25'\ndescription: >-\n  Top 10 countries with the biggest improvement in SPI.\nimage: WHO_SPI.png\ncategories:\n- relplot\n- TidyTuesday\n- PyDyTuesday\nslug: 25B4\nfilters:\n- marimo-team/marimo\n---\n\n# TidyTuesday dataset of [{{<meta date>}}](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/{{<meta iso-date>}})\n\n::: {#c43dfea5 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport matplotlib.dates as mdates\nimport matplotlib.transforms as mtransforms\n```\n:::\n\n\n::: {#a72c4ddc .cell execution_count=2}\n``` {.python .cell-code}\nspi_indicators = pd.read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-11-25/spi_indicators.csv')\nspi_indicators\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>iso3c</th>\n      <th>country</th>\n      <th>region</th>\n      <th>income</th>\n      <th>year</th>\n      <th>population</th>\n      <th>overall_score</th>\n      <th>data_use_score</th>\n      <th>data_services_score</th>\n      <th>data_products_score</th>\n      <th>data_sources_score</th>\n      <th>data_infrastructure_score</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>DNK</td>\n      <td>Denmark</td>\n      <td>Europe &amp; Central Asia</td>\n      <td>High income</td>\n      <td>2023</td>\n      <td>5946952</td>\n      <td>95.255833</td>\n      <td>100.0</td>\n      <td>98.466667</td>\n      <td>90.71250</td>\n      <td>87.100</td>\n      <td>100.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>FIN</td>\n      <td>Finland</td>\n      <td>Europe &amp; Central Asia</td>\n      <td>High income</td>\n      <td>2023</td>\n      <td>5584264</td>\n      <td>95.115417</td>\n      <td>100.0</td>\n      <td>96.433333</td>\n      <td>90.96875</td>\n      <td>88.175</td>\n      <td>100.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>POL</td>\n      <td>Poland</td>\n      <td>Europe &amp; Central Asia</td>\n      <td>High income</td>\n      <td>2023</td>\n      <td>36685849</td>\n      <td>94.653750</td>\n      <td>100.0</td>\n      <td>97.300000</td>\n      <td>84.54375</td>\n      <td>91.425</td>\n      <td>100.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>SWE</td>\n      <td>Sweden</td>\n      <td>Europe &amp; Central Asia</td>\n      <td>High income</td>\n      <td>2023</td>\n      <td>10536632</td>\n      <td>94.410000</td>\n      <td>100.0</td>\n      <td>96.000000</td>\n      <td>90.57500</td>\n      <td>85.475</td>\n      <td>100.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>ESP</td>\n      <td>Spain</td>\n      <td>Europe &amp; Central Asia</td>\n      <td>High income</td>\n      <td>2023</td>\n      <td>48373336</td>\n      <td>94.325000</td>\n      <td>100.0</td>\n      <td>91.200000</td>\n      <td>92.62500</td>\n      <td>87.800</td>\n      <td>100.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>4335</th>\n      <td>VIR</td>\n      <td>Virgin Islands (U.S.)</td>\n      <td>Latin America &amp; Caribbean</td>\n      <td>High income</td>\n      <td>2004</td>\n      <td>108466</td>\n      <td>NaN</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4336</th>\n      <td>PSE</td>\n      <td>West Bank and Gaza</td>\n      <td>Middle East &amp; North Africa</td>\n      <td>Lower middle income</td>\n      <td>2004</td>\n      <td>3236626</td>\n      <td>NaN</td>\n      <td>20.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4337</th>\n      <td>YEM</td>\n      <td>Yemen, Rep.</td>\n      <td>Middle East &amp; North Africa</td>\n      <td>Low income</td>\n      <td>2004</td>\n      <td>20733406</td>\n      <td>NaN</td>\n      <td>20.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4338</th>\n      <td>ZMB</td>\n      <td>Zambia</td>\n      <td>Sub-Saharan Africa</td>\n      <td>Lower middle income</td>\n      <td>2004</td>\n      <td>11188040</td>\n      <td>NaN</td>\n      <td>40.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4339</th>\n      <td>ZWE</td>\n      <td>Zimbabwe</td>\n      <td>Sub-Saharan Africa</td>\n      <td>Lower middle income</td>\n      <td>2004</td>\n      <td>12160881</td>\n      <td>NaN</td>\n      <td>20.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>4340 rows × 12 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#74ac68a7 .cell execution_count=3}\n``` {.python .cell-code}\nspi_indicators['year'] = pd.to_datetime(spi_indicators['year'], format='%Y')\n```\n:::\n\n\n::: {#061fad73 .cell execution_count=4}\n``` {.python .cell-code}\nspi_indicators.columns\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\nIndex(['iso3c', 'country', 'region', 'income', 'year', 'population',\n       'overall_score', 'data_use_score', 'data_services_score',\n       'data_products_score', 'data_sources_score',\n       'data_infrastructure_score'],\n      dtype='object')\n```\n:::\n:::\n\n\n::: {#60f25a43 .cell execution_count=5}\n``` {.python .cell-code}\ncountry_desc = spi_indicators.groupby(['country'])['overall_score'].describe()\ncountry_desc['diff'] = country_desc['max']-country_desc['min']\ntop10_diff = country_desc.nlargest(10, 'diff')\nspi_top10 = spi_indicators[spi_indicators['country'].isin(top10_diff.index)]\nspi_top10\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>iso3c</th>\n      <th>country</th>\n      <th>region</th>\n      <th>income</th>\n      <th>year</th>\n      <th>population</th>\n      <th>overall_score</th>\n      <th>data_use_score</th>\n      <th>data_services_score</th>\n      <th>data_products_score</th>\n      <th>data_sources_score</th>\n      <th>data_infrastructure_score</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>54</th>\n      <td>SAU</td>\n      <td>Saudi Arabia</td>\n      <td>Middle East &amp; North Africa</td>\n      <td>High income</td>\n      <td>2023-01-01</td>\n      <td>36947025</td>\n      <td>81.533333</td>\n      <td>70.0</td>\n      <td>88.366667</td>\n      <td>75.22500</td>\n      <td>79.075000</td>\n      <td>95.0</td>\n    </tr>\n    <tr>\n      <th>61</th>\n      <td>UZB</td>\n      <td>Uzbekistan</td>\n      <td>Europe &amp; Central Asia</td>\n      <td>Lower middle income</td>\n      <td>2023-01-01</td>\n      <td>36412350</td>\n      <td>80.332083</td>\n      <td>80.0</td>\n      <td>76.633333</td>\n      <td>85.04375</td>\n      <td>64.983333</td>\n      <td>95.0</td>\n    </tr>\n    <tr>\n      <th>71</th>\n      <td>ARE</td>\n      <td>United Arab Emirates</td>\n      <td>Middle East &amp; North Africa</td>\n      <td>High income</td>\n      <td>2023-01-01</td>\n      <td>9516871</td>\n      <td>77.635000</td>\n      <td>90.0</td>\n      <td>79.500000</td>\n      <td>71.15000</td>\n      <td>62.525000</td>\n      <td>85.0</td>\n    </tr>\n    <tr>\n      <th>80</th>\n      <td>BFA</td>\n      <td>Burkina Faso</td>\n      <td>Sub-Saharan Africa</td>\n      <td>Low income</td>\n      <td>2023-01-01</td>\n      <td>23251485</td>\n      <td>74.309167</td>\n      <td>100.0</td>\n      <td>69.000000</td>\n      <td>80.38750</td>\n      <td>42.158333</td>\n      <td>80.0</td>\n    </tr>\n    <tr>\n      <th>92</th>\n      <td>ZWE</td>\n      <td>Zimbabwe</td>\n      <td>Sub-Saharan Africa</td>\n      <td>Lower middle income</td>\n      <td>2023-01-01</td>\n      <td>16665409</td>\n      <td>69.732500</td>\n      <td>100.0</td>\n      <td>67.033333</td>\n      <td>83.38750</td>\n      <td>38.241667</td>\n      <td>60.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>4289</th>\n      <td>SAU</td>\n      <td>Saudi Arabia</td>\n      <td>Middle East &amp; North Africa</td>\n      <td>High income</td>\n      <td>2004-01-01</td>\n      <td>23661808</td>\n      <td>NaN</td>\n      <td>20.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4299</th>\n      <td>SOM</td>\n      <td>Somalia</td>\n      <td>Sub-Saharan Africa</td>\n      <td>Low income</td>\n      <td>2004-01-01</td>\n      <td>10117354</td>\n      <td>NaN</td>\n      <td>20.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4327</th>\n      <td>ARE</td>\n      <td>United Arab Emirates</td>\n      <td>Middle East &amp; North Africa</td>\n      <td>High income</td>\n      <td>2004-01-01</td>\n      <td>3993339</td>\n      <td>NaN</td>\n      <td>20.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4331</th>\n      <td>UZB</td>\n      <td>Uzbekistan</td>\n      <td>Europe &amp; Central Asia</td>\n      <td>Lower middle income</td>\n      <td>2004-01-01</td>\n      <td>25864350</td>\n      <td>NaN</td>\n      <td>40.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4339</th>\n      <td>ZWE</td>\n      <td>Zimbabwe</td>\n      <td>Sub-Saharan Africa</td>\n      <td>Lower middle income</td>\n      <td>2004-01-01</td>\n      <td>12160881</td>\n      <td>NaN</td>\n      <td>20.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>200 rows × 12 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#8ab656cf .cell execution_count=6}\n``` {.python .cell-code}\ndf_melt_top10 = pd.melt(spi_top10, id_vars=['country','year'], \\\n            value_vars=['overall_score', 'data_use_score', 'data_services_score', 'data_products_score', 'data_sources_score', 'data_infrastructure_score'],\\\n            var_name='Score_type', value_name='Scores')\ndf_melt_top10\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>country</th>\n      <th>year</th>\n      <th>Score_type</th>\n      <th>Scores</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Saudi Arabia</td>\n      <td>2023-01-01</td>\n      <td>overall_score</td>\n      <td>81.533333</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Uzbekistan</td>\n      <td>2023-01-01</td>\n      <td>overall_score</td>\n      <td>80.332083</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>United Arab Emirates</td>\n      <td>2023-01-01</td>\n      <td>overall_score</td>\n      <td>77.635000</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Burkina Faso</td>\n      <td>2023-01-01</td>\n      <td>overall_score</td>\n      <td>74.309167</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Zimbabwe</td>\n      <td>2023-01-01</td>\n      <td>overall_score</td>\n      <td>69.732500</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>1195</th>\n      <td>Saudi Arabia</td>\n      <td>2004-01-01</td>\n      <td>data_infrastructure_score</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1196</th>\n      <td>Somalia</td>\n      <td>2004-01-01</td>\n      <td>data_infrastructure_score</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1197</th>\n      <td>United Arab Emirates</td>\n      <td>2004-01-01</td>\n      <td>data_infrastructure_score</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1198</th>\n      <td>Uzbekistan</td>\n      <td>2004-01-01</td>\n      <td>data_infrastructure_score</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1199</th>\n      <td>Zimbabwe</td>\n      <td>2004-01-01</td>\n      <td>data_infrastructure_score</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>1200 rows × 4 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#a9071e6f .cell execution_count=7}\n``` {.python .cell-code}\nsns.set_context(\"notebook\", font_scale=1.5)\n\ng = sns.relplot(data=df_melt_top10, x='year', y='Scores', hue='country', kind='line', col='Score_type', \\\n            col_wrap=3, legend=False, col_order=['data_use_score', 'data_sources_score', 'data_infrastructure_score', 'data_products_score', 'data_services_score', 'overall_score'])\n\noriginal_ticks = g.axes.flatten()[0].get_xticks()   # or use one representative axis\n\nkeep = original_ticks#[::2]\n#if original_ticks[-1] not in keep:\n#    keep = list(keep) + [original_ticks[-1]]\n\nfor ind, ax in enumerate(g.axes.flatten()):\n    new_title = ' '.join(ax.get_title().removesuffix('_score').split()[-1].split('_')).capitalize()\n    \n    ax.set_title(new_title, y=0.9, color='#555555')\n#    ax.tick_params(axis='x', rotation=45)\n    ax.set_xlabel(\"\")\n    ax.set_xticks(keep)\n    ax.xaxis.set_major_formatter(mdates.DateFormatter(\"%y\"))\n    ax.margins(x=0)\n    ax.set_facecolor('#F5F5F5')\n    for labelx, labely in zip(ax.get_xticklabels(), ax.get_yticklabels()):\n        labelx.set_fontfamily('monospace')\n        labely.set_fontfamily('monospace')\n    if (ind not in [0,3]):\n        ax.spines['left'].set_visible(False)\n        ax.tick_params(axis='y', left=False, labelleft=False)\n        labels = ax.get_xticklabels()\n        if labels:\n            labels[1].set_visible(False)   \n\nfig = g.fig\nax = g.axes.flatten()[1]   # facet to annotate\n\n# create an offset transform: 5 points right, 0 points up\ntext_trans = mtransforms.offset_copy(ax.transData, fig=fig,\n                                     x=5, y=0, units='points')\n\ny_offset = 3\nfor line, country in zip(ax.lines, df_melt_top10['country'].unique()):\n    x_end = line.get_xdata()[-1]\n    y_end = line.get_ydata()[-1]\n\n    if (country in ['Uzbekistan', 'Lebanon']):\n        y_end += y_offset\n    if (country in ['Marshall Islands', 'Zimbabwe']):\n        y_end -= y_offset\n    \n\n    fig.text(\n        x_end,\n        y_end,\n        country,\n        transform=text_trans,   \n        ha='left',\n        va='center',\n        color=line.get_color(),\n        clip_on=False           \n    )\n\n\ng.fig.subplots_adjust(wspace=0, hspace=0)\ng.fig.suptitle(\"Top 10 countries with the greatest improvement in the overall score \\nof the World Bank Statistical Performance Indicators from 2004 \\u2013 2023\", fontfamily='Serif', y=1.025)\ng.fig.patch.set_facecolor('#F5F5F5')\nplt.savefig('WHO_SPI.png', dpi=300, bbox_inches='tight')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](WHO_SPI_files/figure-html/cell-8-output-1.png){}\n:::\n:::\n\n\n",
    "supporting": [
      "WHO_SPI_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}