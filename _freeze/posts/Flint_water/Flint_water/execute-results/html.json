{
  "hash": "7b775174ccd9aae8dc3673570b3e4b77",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Lead concentration in Flint water samples in 2015\nmarimo-version: 0.17.0\nauthor: Manish Datt\ndate: 2025-11-4\niso-date: 2025-11-4\ndescription: >-\n  Descriptive statistics for the Lead distributions.\nimage: Flint_water.png\ncategories:\n- Swarmplot\n- TidyTuesday\n- PyDyTuesday\nslug: 25B1\nfilters:\n- marimo-team/marimo\n---\n\n::: {#9c3f7466 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom matplotlib.ticker import FuncFormatter\nimport seaborn as sns\nfrom scipy.stats import skew, kurtosis\nimport textwrap\n```\n:::\n\n\n::: {#66adb840 .cell execution_count=2}\n``` {.python .cell-code}\nflint_mdeq = pd.read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-11-04/flint_mdeq.csv')\nflint_vt = pd.read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-11-04/flint_vt.csv')\n```\n:::\n\n\n::: {#b16d7f52 .cell execution_count=3}\n``` {.python .cell-code}\nflint_mdeq\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sample</th>\n      <th>lead</th>\n      <th>lead2</th>\n      <th>notes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>104</td>\n      <td>NaN</td>\n      <td>sample removed: house had a filter</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>10</td>\n      <td>10.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>6</td>\n      <td>6.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>5</td>\n      <td>5.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>66</th>\n      <td>67</td>\n      <td>2</td>\n      <td>2.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>67</th>\n      <td>68</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>68</th>\n      <td>69</td>\n      <td>3</td>\n      <td>3.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>69</th>\n      <td>70</td>\n      <td>5</td>\n      <td>5.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>70</th>\n      <td>71</td>\n      <td>2</td>\n      <td>2.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>71 rows × 4 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#69556d5c .cell execution_count=4}\n``` {.python .cell-code}\nsns.scatterplot(data=flint_mdeq, x='sample', y='lead')\n```\n\n::: {.cell-output .cell-output-display}\n![](Flint_water_files/figure-html/cell-5-output-1.png){}\n:::\n:::\n\n\n::: {#a02fc68d .cell execution_count=5}\n``` {.python .cell-code}\nplt.scatter(flint_mdeq['sample'],flint_mdeq['lead2'])\n#plt.scatter(flint_vt['sample'],flint_vt['lead'])\n```\n\n::: {.cell-output .cell-output-display}\n![](Flint_water_files/figure-html/cell-6-output-1.png){}\n:::\n:::\n\n\n::: {#011ba953 .cell execution_count=6}\n``` {.python .cell-code}\nflint_mdeq.describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sample</th>\n      <th>lead</th>\n      <th>lead2</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>71.000000</td>\n      <td>71.000000</td>\n      <td>69.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>36.000000</td>\n      <td>7.309859</td>\n      <td>5.724638</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>20.639767</td>\n      <td>14.347316</td>\n      <td>8.336461</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>1.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>18.500000</td>\n      <td>2.000000</td>\n      <td>2.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>36.000000</td>\n      <td>3.000000</td>\n      <td>3.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>53.500000</td>\n      <td>6.500000</td>\n      <td>6.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>71.000000</td>\n      <td>104.000000</td>\n      <td>42.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#fcf6f7e1 .cell execution_count=7}\n``` {.python .cell-code}\ndesc = flint_mdeq[['lead','lead2']].describe().T[['mean','50%', 'min','max']]\ndesc\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>mean</th>\n      <th>50%</th>\n      <th>min</th>\n      <th>max</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>lead</th>\n      <td>7.309859</td>\n      <td>3.0</td>\n      <td>0.0</td>\n      <td>104.0</td>\n    </tr>\n    <tr>\n      <th>lead2</th>\n      <td>5.724638</td>\n      <td>3.0</td>\n      <td>0.0</td>\n      <td>42.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#ef943bcf .cell execution_count=8}\n``` {.python .cell-code}\ndesc.plot(kind='bar', figsize=(10,6))\n```\n\n::: {.cell-output .cell-output-display}\n![](Flint_water_files/figure-html/cell-9-output-1.png){}\n:::\n:::\n\n\n::: {#2207be4d .cell execution_count=9}\n``` {.python .cell-code}\nsns.swarmplot(flint_mdeq[['lead','lead2']])\n```\n\n::: {.cell-output .cell-output-display}\n![](Flint_water_files/figure-html/cell-10-output-1.png){}\n:::\n:::\n\n\n::: {#8a467ee0 .cell execution_count=10}\n``` {.python .cell-code}\nflint_mdeq\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sample</th>\n      <th>lead</th>\n      <th>lead2</th>\n      <th>notes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>104</td>\n      <td>NaN</td>\n      <td>sample removed: house had a filter</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>10</td>\n      <td>10.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>6</td>\n      <td>6.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>5</td>\n      <td>5.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>66</th>\n      <td>67</td>\n      <td>2</td>\n      <td>2.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>67</th>\n      <td>68</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>68</th>\n      <td>69</td>\n      <td>3</td>\n      <td>3.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>69</th>\n      <td>70</td>\n      <td>5</td>\n      <td>5.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>70</th>\n      <td>71</td>\n      <td>2</td>\n      <td>2.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>71 rows × 4 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#50c88ba9 .cell execution_count=11}\n``` {.python .cell-code}\nflint_mdeq['diff'] = flint_mdeq.apply(\n    lambda row: row['lead'] if pd.isna(row['lead2']) else None,\n    axis=1\n)\n```\n:::\n\n\n::: {#f6b51ed2 .cell execution_count=12}\n``` {.python .cell-code}\nd = flint_mdeq['lead2'].dropna()\nprint(\"Skewness:\", skew(d))\nprint(\"Kurtosis:\", kurtosis(d))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSkewness: 2.9376969574953016\nKurtosis: 9.133276189367894\n```\n:::\n:::\n\n\n::: {#2707cd6e .cell execution_count=13}\n``` {.python .cell-code}\nmelted = flint_mdeq[['lead', 'lead2','diff']].melt(var_name='Source', value_name='Lead Level')\nfig,ax=plt.subplots(figsize=(6, 6))\nax2 = ax.twinx()\nsns.swarmplot(x='Source', y='Lead Level', data=melted[melted['Source'].isin(['lead', 'lead2'])], size=6, hue='Source')\ntemp = melted[melted['Source']=='diff']\ntemp['Source'] = temp['Source'].str.replace('diff','lead')\nplt.scatter(temp['Source'], temp['Lead Level'],marker='*', color='red',s=100,zorder=10, alpha=0.5)\ndesc.plot(ax=ax, alpha=0, legend=False)\nax.set_yticks(desc.loc['lead'])\nax2.set_yticks(desc.loc['lead2'])\n#ax.grid(True, axis='y', color='#1f77b4')\nyticks = ax.get_yticks()\n\n# Get x-axis limits\nxlim = ax.get_xlim()\nx_half = (xlim[0] + xlim[1]) / 2  # midpoint of x-axis\n\n# Draw custom horizontal lines from left to midpoint\nfor ytick in yticks:\n    ax.hlines(y=ytick, xmin=xlim[0], xmax=x_half-0.1, color='#1f77b4', linestyle='--', linewidth=0.5)\n\n#ax2.grid(True, axis='y', color='#ff7f0e')\nyticks = ax2.get_yticks()\n\n# Get x-axis limits\nxlim = ax2.get_xlim()\nx_half = (xlim[0] + xlim[1]) / 2  # midpoint of x-axis\n\n# Draw custom horizontal lines from left to midpoint\nfor ytick in yticks:\n    ax2.hlines(y=ytick, xmin=xlim[1], xmax=x_half+0.1, color='#ff7f0e', linestyle='--', linewidth=0.5)\n\nax.tick_params(axis='both', which='both', length=0)\nax2.tick_params(axis='both', which='both', length=0)\nformatter = FuncFormatter(lambda val, pos: f'{val:.1f}')\nax2.yaxis.set_major_formatter(formatter)\nax.text(0.5, -1, 'Min',ha='center')\nax.text(0.5, 2.5, 'Median',ha='center')\nax.text(0.35, 7.5, 'Mean',ha='center', color='#1f77b4')\nax.text(0.6, 6, 'Mean',ha='center', color='#ff7f0e')\nax.text(0.35, 104, 'Max',ha='center', color='#1f77b4')\nax.text(0.6, 42, 'Max',ha='center', color='#ff7f0e')\n\nax.text(0,80,f'Skewness: {round(skew(flint_mdeq[\"lead\"]),2)}', ha='center', color='#1f77b4')\nax.text(0,75,f'Kurtosis: {round(kurtosis(flint_mdeq[\"lead\"]),2)}', ha='center', color='#1f77b4')\n\nax.text(1,80,f'Skewness: {round(skew(flint_mdeq[\"lead2\"].dropna()),2)}', ha='center', color='#ff7f0e')\nax.text(1,75,f'Kurtosis: {round(kurtosis(flint_mdeq[\"lead2\"].dropna()),2)}', ha='center', color='#ff7f0e')\n\nplt.ylabel('')\nsns.despine(left=True,bottom=True)\ntitle=\"Distribution of Lead concentration in Flint water samples. The two leptokurtic distributions differ by two data points (red asterisks).\"\nplt.title('\\n'.join(textwrap.wrap(title,50)), fontfamily='Serif', fontsize=14)\nax.set_facecolor('#EEEEEE')  \nfig.set_facecolor('#EEEEEE')\nplt.tight_layout()\nplt.savefig('Flint_water.png', dpi=300, bbox_inches='tight')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](Flint_water_files/figure-html/cell-14-output-1.png){}\n:::\n:::\n\n\n::: {#9750f508 .cell execution_count=14}\n``` {.python .cell-code}\nsns.histplot(flint_mdeq['lead2'], kde=True)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](Flint_water_files/figure-html/cell-15-output-1.png){}\n:::\n:::\n\n\n",
    "supporting": [
      "Flint_water_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}