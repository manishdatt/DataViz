{
  "hash": "314a0b2715d820210919dbff7fa47d24",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Cars in Qatar\nmarimo-version: 0.17.0\nauthor: Manish Datt\ndate: '2025-12-09'\niso-date: '2025-12-09'\ndescription: >-\n  Price distribution of cars by type and engine type.\nimage: Quatarcars.png\ncategories:\n- Swarmplot\n- TidyTuesday\n- PyDyTuesday\nslug: 25C2\nfilters:\n- marimo-team/marimo\n---\n\n# TidyTuesday dataset of [{{<meta date>}}](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/{{<meta iso-date>}})\n\n::: {#9501c3c1 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.ticker as ticker\nimport matplotlib.patches as patches\nimport matplotlib as mpl\n```\n:::\n\n\n::: {#18fe9dcb .cell execution_count=2}\n``` {.python .cell-code}\nqatarcars = pd.read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-12-09/qatarcars.csv')\nqatarcars\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>origin</th>\n      <th>make</th>\n      <th>model</th>\n      <th>length</th>\n      <th>width</th>\n      <th>height</th>\n      <th>seating</th>\n      <th>trunk</th>\n      <th>economy</th>\n      <th>horsepower</th>\n      <th>price</th>\n      <th>mass</th>\n      <th>performance</th>\n      <th>type</th>\n      <th>enginetype</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Germany</td>\n      <td>BMW</td>\n      <td>3 Series Sedan</td>\n      <td>4.713</td>\n      <td>1.827</td>\n      <td>1.440</td>\n      <td>5</td>\n      <td>59</td>\n      <td>7.6</td>\n      <td>386</td>\n      <td>164257</td>\n      <td>1653</td>\n      <td>4.3</td>\n      <td>Sedan</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Germany</td>\n      <td>BMW</td>\n      <td>X1</td>\n      <td>4.505</td>\n      <td>1.845</td>\n      <td>1.642</td>\n      <td>5</td>\n      <td>505</td>\n      <td>6.6</td>\n      <td>313</td>\n      <td>264000</td>\n      <td>1701</td>\n      <td>5.4</td>\n      <td>SUV</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Germany</td>\n      <td>Audi</td>\n      <td>RS Q8</td>\n      <td>5.012</td>\n      <td>1.694</td>\n      <td>1.998</td>\n      <td>5</td>\n      <td>605</td>\n      <td>12.1</td>\n      <td>600</td>\n      <td>630000</td>\n      <td>2490</td>\n      <td>3.6</td>\n      <td>SUV</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Germany</td>\n      <td>Audi</td>\n      <td>RS3</td>\n      <td>4.542</td>\n      <td>1.851</td>\n      <td>1.412</td>\n      <td>5</td>\n      <td>321</td>\n      <td>8.7</td>\n      <td>400</td>\n      <td>310000</td>\n      <td>1565</td>\n      <td>3.8</td>\n      <td>Sedan</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Germany</td>\n      <td>Audi</td>\n      <td>A3</td>\n      <td>4.456</td>\n      <td>1.960</td>\n      <td>1.416</td>\n      <td>5</td>\n      <td>425</td>\n      <td>6.5</td>\n      <td>180</td>\n      <td>165000</td>\n      <td>1325</td>\n      <td>6.7</td>\n      <td>Sedan</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>100</th>\n      <td>South Korea</td>\n      <td>Kia</td>\n      <td>Picanto</td>\n      <td>3.595</td>\n      <td>1.595</td>\n      <td>1.495</td>\n      <td>5</td>\n      <td>255</td>\n      <td>6.0</td>\n      <td>84</td>\n      <td>58000</td>\n      <td>976</td>\n      <td>13.7</td>\n      <td>Hatchback</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>101</th>\n      <td>PR China</td>\n      <td>Bestune</td>\n      <td>Oley</td>\n      <td>4.555</td>\n      <td>1.660</td>\n      <td>1.465</td>\n      <td>4</td>\n      <td>300</td>\n      <td>6.7</td>\n      <td>101</td>\n      <td>35000</td>\n      <td>1150</td>\n      <td>12.1</td>\n      <td>Hatchback</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>102</th>\n      <td>Japan</td>\n      <td>Mitsubishi</td>\n      <td>Mirage</td>\n      <td>3.780</td>\n      <td>1.665</td>\n      <td>1.500</td>\n      <td>5</td>\n      <td>235</td>\n      <td>4.8</td>\n      <td>77</td>\n      <td>44000</td>\n      <td>1050</td>\n      <td>13.9</td>\n      <td>Hatchback</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>103</th>\n      <td>South Korea</td>\n      <td>Hyundai</td>\n      <td>Grand i10</td>\n      <td>3.665</td>\n      <td>1.660</td>\n      <td>1.500</td>\n      <td>5</td>\n      <td>252</td>\n      <td>5.3</td>\n      <td>86</td>\n      <td>46900</td>\n      <td>1840</td>\n      <td>14.5</td>\n      <td>Hatchback</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>104</th>\n      <td>PR China</td>\n      <td>MG</td>\n      <td>MG3 Luxury</td>\n      <td>4.055</td>\n      <td>1.729</td>\n      <td>1.504</td>\n      <td>5</td>\n      <td>293</td>\n      <td>6.7</td>\n      <td>109</td>\n      <td>57000</td>\n      <td>1308</td>\n      <td>10.8</td>\n      <td>Hatchback</td>\n      <td>Petrol</td>\n    </tr>\n  </tbody>\n</table>\n<p>105 rows × 15 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#a6c42845 .cell execution_count=3}\n``` {.python .cell-code}\ndef millions_formatter(x, pos):\n    \"\"\"The two args are the value and tick position\"\"\"\n    return f'{x / 1000000:.1f}M'\n```\n:::\n\n\n::: {#cc893d3b .cell execution_count=4}\n``` {.python .cell-code}\ndf_melted = pd.melt(qatarcars, id_vars=['type', 'enginetype'], value_vars=['price'])\ndf_melted['type_engine'] = df_melted['type'] + '_' + df_melted['enginetype']\ndf_melted.sort_values(by=['type', 'enginetype'], ascending=False, inplace=True)\ndf_melted\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>type</th>\n      <th>enginetype</th>\n      <th>variable</th>\n      <th>value</th>\n      <th>type_engine</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Sedan</td>\n      <td>Petrol</td>\n      <td>price</td>\n      <td>164257</td>\n      <td>Sedan_Petrol</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Sedan</td>\n      <td>Petrol</td>\n      <td>price</td>\n      <td>310000</td>\n      <td>Sedan_Petrol</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Sedan</td>\n      <td>Petrol</td>\n      <td>price</td>\n      <td>165000</td>\n      <td>Sedan_Petrol</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Sedan</td>\n      <td>Petrol</td>\n      <td>price</td>\n      <td>1281000</td>\n      <td>Sedan_Petrol</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>Sedan</td>\n      <td>Petrol</td>\n      <td>price</td>\n      <td>458000</td>\n      <td>Sedan_Petrol</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>98</th>\n      <td>Coupe</td>\n      <td>Petrol</td>\n      <td>price</td>\n      <td>224500</td>\n      <td>Coupe_Petrol</td>\n    </tr>\n    <tr>\n      <th>99</th>\n      <td>Coupe</td>\n      <td>Petrol</td>\n      <td>price</td>\n      <td>125000</td>\n      <td>Coupe_Petrol</td>\n    </tr>\n    <tr>\n      <th>69</th>\n      <td>Coupe</td>\n      <td>Hybrid</td>\n      <td>price</td>\n      <td>1150000</td>\n      <td>Coupe_Hybrid</td>\n    </tr>\n    <tr>\n      <th>78</th>\n      <td>Coupe</td>\n      <td>Hybrid</td>\n      <td>price</td>\n      <td>945700</td>\n      <td>Coupe_Hybrid</td>\n    </tr>\n    <tr>\n      <th>75</th>\n      <td>Coupe</td>\n      <td>Electric</td>\n      <td>price</td>\n      <td>8010200</td>\n      <td>Coupe_Electric</td>\n    </tr>\n  </tbody>\n</table>\n<p>105 rows × 5 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#976e3ae8 .cell execution_count=5}\n``` {.python .cell-code}\ndf_max = qatarcars.loc[qatarcars.groupby(['type', 'enginetype'])['price'].idxmax()]\ndf_max.sort_values(by=['type', 'enginetype'], ascending=False, inplace=True)\ndf_max\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>origin</th>\n      <th>make</th>\n      <th>model</th>\n      <th>length</th>\n      <th>width</th>\n      <th>height</th>\n      <th>seating</th>\n      <th>trunk</th>\n      <th>economy</th>\n      <th>horsepower</th>\n      <th>price</th>\n      <th>mass</th>\n      <th>performance</th>\n      <th>type</th>\n      <th>enginetype</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>5</th>\n      <td>Germany</td>\n      <td>Mercedes</td>\n      <td>Maybach</td>\n      <td>5.469</td>\n      <td>1.921</td>\n      <td>1.510</td>\n      <td>4</td>\n      <td>500</td>\n      <td>13.3</td>\n      <td>612</td>\n      <td>1281000</td>\n      <td>2376</td>\n      <td>4.1</td>\n      <td>Sedan</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>68</th>\n      <td>UK</td>\n      <td>Bentley</td>\n      <td>Flying Spur</td>\n      <td>5.316</td>\n      <td>2.013</td>\n      <td>1.483</td>\n      <td>5</td>\n      <td>351</td>\n      <td>10.9</td>\n      <td>521</td>\n      <td>1300000</td>\n      <td>2646</td>\n      <td>3.5</td>\n      <td>Sedan</td>\n      <td>Hybrid</td>\n    </tr>\n    <tr>\n      <th>88</th>\n      <td>PR China</td>\n      <td>BYD</td>\n      <td>Seal</td>\n      <td>4.800</td>\n      <td>1.875</td>\n      <td>1.460</td>\n      <td>5</td>\n      <td>400</td>\n      <td>NaN</td>\n      <td>204</td>\n      <td>164000</td>\n      <td>2185</td>\n      <td>3.8</td>\n      <td>Sedan</td>\n      <td>Electric</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Germany</td>\n      <td>Mercedes</td>\n      <td>G-Wagon</td>\n      <td>4.613</td>\n      <td>1.984</td>\n      <td>1.969</td>\n      <td>5</td>\n      <td>480</td>\n      <td>13.1</td>\n      <td>585</td>\n      <td>1011500</td>\n      <td>2588</td>\n      <td>4.3</td>\n      <td>SUV</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>65</th>\n      <td>Sweden</td>\n      <td>Volvo</td>\n      <td>XC90</td>\n      <td>4.953</td>\n      <td>2.140</td>\n      <td>1.776</td>\n      <td>7</td>\n      <td>71</td>\n      <td>7.1</td>\n      <td>249</td>\n      <td>245000</td>\n      <td>2315</td>\n      <td>5.3</td>\n      <td>SUV</td>\n      <td>Hybrid</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Germany</td>\n      <td>Mercedes</td>\n      <td>EQS</td>\n      <td>5.216</td>\n      <td>1.926</td>\n      <td>1.512</td>\n      <td>5</td>\n      <td>610</td>\n      <td>NaN</td>\n      <td>333</td>\n      <td>564500</td>\n      <td>2495</td>\n      <td>5.6</td>\n      <td>SUV</td>\n      <td>Electric</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>Japan</td>\n      <td>Honda</td>\n      <td>Civic Type R</td>\n      <td>4.594</td>\n      <td>1.890</td>\n      <td>1.407</td>\n      <td>5</td>\n      <td>609</td>\n      <td>9.8</td>\n      <td>315</td>\n      <td>189999</td>\n      <td>1446</td>\n      <td>5.4</td>\n      <td>Hatchback</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>Italy</td>\n      <td>Bugatti</td>\n      <td>Centodieci</td>\n      <td>4.544</td>\n      <td>2.047</td>\n      <td>1.200</td>\n      <td>2</td>\n      <td>0</td>\n      <td>22.5</td>\n      <td>1600</td>\n      <td>33000000</td>\n      <td>1976</td>\n      <td>2.4</td>\n      <td>Coupe</td>\n      <td>Petrol</td>\n    </tr>\n    <tr>\n      <th>69</th>\n      <td>UK</td>\n      <td>Bentley</td>\n      <td>Continental GT</td>\n      <td>4.806</td>\n      <td>2.227</td>\n      <td>1.403</td>\n      <td>5</td>\n      <td>235</td>\n      <td>10.9</td>\n      <td>521</td>\n      <td>1150000</td>\n      <td>2459</td>\n      <td>3.3</td>\n      <td>Coupe</td>\n      <td>Hybrid</td>\n    </tr>\n    <tr>\n      <th>75</th>\n      <td>UK</td>\n      <td>Lotus</td>\n      <td>Evija</td>\n      <td>4.459</td>\n      <td>2.000</td>\n      <td>1.122</td>\n      <td>2</td>\n      <td>0</td>\n      <td>NaN</td>\n      <td>1973</td>\n      <td>8010200</td>\n      <td>1887</td>\n      <td>2.9</td>\n      <td>Coupe</td>\n      <td>Electric</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#13320c40 .cell execution_count=6}\n``` {.python .cell-code}\nbg_color = '#F5F5F5'\nplot_colors = mpl.rcParams[\"axes.prop_cycle\"].by_key()[\"color\"]\nfig, ax = plt.subplots(figsize=(8, 4))\nsns.swarmplot(data=df_melted, x='type_engine', y='value', log_scale=True, hue='enginetype', legend=False)\nax.yaxis.set_major_formatter(ticker.FuncFormatter(millions_formatter))\nplt.ylabel('Qatari Riyal (1M QAR ≈ 275K USD)')\nplt.xlabel('')\n\nax.axvspan(2.5, 5.5, color='#FAFAFA', zorder=0)\nax.axvspan(6.5, 9.25, color='#FAFAFA', zorder=0)\n\nax.text(1, 25000, \"Sedan\", ha='center')\nax.text(4, 25000, \"SUV\", ha='center')\nax.text(6, 25000, \"Hatchback\", ha='center')\nax.text(8, 25000, \"Coupe\", ha='center')\n\n# label the max values\nfor ind, (i, row) in enumerate(df_max.iterrows()):\n    price_M = f\"{row['price']/1000000:.2f}M\"\n    if (row['enginetype'] == 'Petrol'):\n      ax.text(ind, row['price']*1.2, f\"{row['make']}, {row['model']} \\n {price_M}\", ha='center', color=plot_colors[0])\n    elif (row['enginetype'] == 'Hybrid'):\n      if(row['model'] == 'Flying Spur'):\n        ax.text(ind, row['price']*0.45, f\"{row['make']}, {row['model']} \\n {price_M}\", ha='center', color=plot_colors[1])\n      else:\n        ax.text(ind, row['price']*1.2, f\"{row['make']}, {row['model']} \\n {price_M}\", ha='center', color=plot_colors[1])\n    else:\n      ax.text(ind, row['price']*1.2, f\"{row['make']}, {row['model']} \\n {price_M}\", ha='center', color=plot_colors[2])\n\n\nsns.despine(bottom=True, left=True)\nax.tick_params(bottom=False, labelbottom=False)\nax.tick_params(axis='y', which='both', left=False, pad=-5)\nax.grid(True, axis='y', linestyle=':', alpha=0.5)\nax.figure.set_facecolor(bg_color)\nax.set_facecolor(bg_color)\n\nplt.title(\"Price distribution of qatarcars by type and engine type.\\nMax in each category is labelled.\", \\\n          ha='left', x=-0.05, fontfamily='Serif', fontsize=14)\nax.annotate(\n    'Petrol', \n    xy=(-0.09, 1), xycoords='axes fraction',\n    xytext=(0.015, 0.10), textcoords='axes fraction', color=plot_colors[0],\n    rotation=90, fontfamily='monospace'\n)\n\nax.annotate(\n    'Electric', \n    xy=(-0.09, 1), xycoords='axes fraction',\n    xytext=(0.54, 0.03), textcoords='axes fraction', color=plot_colors[2],\n    rotation=90, fontfamily='monospace'\n)\n\nax.annotate(\n    'Hybrid', \n    xy=(-0.09, 1), xycoords='axes fraction',\n    xytext=(0.83, 0.3), textcoords='axes fraction', color=plot_colors[1],\n    rotation=90, fontfamily='monospace'\n)\nplt.tight_layout()\nplt.savefig('Qatarcars.png', dpi=300, bbox_inches='tight')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](Qatarcars_files/figure-html/cell-7-output-1.png){}\n:::\n:::\n\n\n",
    "supporting": [
      "Qatarcars_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}